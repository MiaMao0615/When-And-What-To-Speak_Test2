# 多窗口联调测试指南

## 步骤 1: 构建项目
```powershell
cd "D:\Task_design\my-chat-app copy"
npm run build
```

## 步骤 2: 启动静态服务器
在**同一个终端**中运行：
```powershell
npx serve dist -l 5173
```

你会看到类似输出：
```
   ┌─────────────────────────────────────────┐
   │                                         │
   │   Serving!                              │
   │                                         │
   │   - Local:    http://localhost:5173     │
   │   - Network:  http://10.1.100.83:5173   │
   │                                         │
   └─────────────────────────────────────────┘
```

**注意**: 这个命令会一直运行，**不要关闭这个终端窗口**。

## 步骤 3: 多窗口联调测试

### 方法 1: 在同一浏览器中打开多个标签页/窗口
1. 打开第一个窗口：访问 `http://localhost:5173`
   - 填写第一个用户的昵称和简介
   - 点击"提交并连接"

2. 打开第二个窗口：新建标签页或窗口，访问 `http://localhost:5173`
   - 填写第二个用户的昵称和简介
   - 点击"提交并连接"

3. 重复步骤 2，打开第三个、第四个...窗口

### 方法 2: 使用隐身/无痕模式
- **Chrome/Edge**: `Ctrl + Shift + N` 创建新的隐身窗口
- **Firefox**: `Ctrl + Shift + P` 创建新的隐私浏览窗口
- 每个隐身窗口都可以独立登录，模拟不同的用户

### 方法 3: 使用不同浏览器
- 窗口1：Chrome 访问 `http://localhost:5173`
- 窗口2：Edge 访问 `http://localhost:5173`
- 窗口3：Firefox 访问 `http://localhost:5173`

## 步骤 4: 测试匿名化效果

### 验证点：
1. ✅ **编号系统**: 检查所有用户（包括AI）是否都显示为"用户1"、"用户2"等编号
2. ✅ **样式统一**: 检查AI消息和人类消息的气泡样式是否完全一致
3. ✅ **无调试信息**: 确认右侧没有Agent Monitor面板
4. ✅ **昵称隐藏**: 确认聊天界面中没有显示实际昵称，只有编号
5. ✅ **图灵测试**: 尝试从对话内容判断哪个是AI

## 步骤 5: 停止服务器
在运行 `serve` 的终端中按 `Ctrl + C` 停止服务器

## 故障排除

### 端口被占用
如果 5173 端口被占用，可以使用其他端口：
```powershell
npx serve dist -l 5174
```
然后访问 `http://localhost:5174`

### 无法连接WebSocket
确保后端服务器在 `8765` 端口运行，检查：
- WebSocket地址: `ws://localhost:8765`
- 后端服务是否已启动

### 需要重新构建
如果修改了代码，需要重新构建：
```powershell
npm run build
```
然后刷新浏览器即可（不需要重启 serve）
